import re
import pytest

from regex_exploit_fixed import regex_exploit_fixed


def test_regex_eval():
    text = "123.456.789"
    match = re.search("(.+)\.(.+)\.(.+)", text)
    assert match is not None


@pytest.mark.timeout(5)
def test_regex_exploit_ok():
    text = "AAAAAAAAAAAAAAAAAAAAAAAAC"
    with pytest.raises(ValueError) as exc_info:
        regex_exploit_fixed(text)


@pytest.mark.timeout(5)
def test_regex_exploit_fail():
    text = "AAAAAAAAAAAAAAAAAAAAAAAAAAAC"
    with pytest.raises(ValueError) as exc_info:
        regex_exploit_fixed(text)
