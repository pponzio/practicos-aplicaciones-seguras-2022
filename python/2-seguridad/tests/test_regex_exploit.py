import re
import pytest

from regex_exploit import regex_exploit


def test_regex_eval():
    text = "123.456.789"
    match = re.search("(.+)\.(.+)\.(.+)", text)
    assert match.group() == text


@pytest.mark.timeout(5)
def test_regex_exploit_ok():
    text = "AAAAAAAAAAAAAAAAAAAAAAAAC"
    res = regex_exploit(text)
    assert not res


@pytest.mark.timeout(5)
def test_regex_exploit_fail():
    text = "AAAAAAAAAAAAAAAAAAAAAAAAAAAC"
    res = regex_exploit(text)
    assert not res
